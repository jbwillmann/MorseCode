<!DOCTYPE html>
<html lang="en">
    
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Morse Code Program Help</title>
        <meta name="description" content="Morse Code Help.">
        <link rel="stylesheet" href="main.css">
    </head>
    <body>
        
        <h1>Morse Code Help</h1>
        <p>
            This helps file was built using Brackets, an open-source code editor. I used Brackets built-in index.html and main.css files that Brackets uses to introduce the program when it is first launched, as templates for this document. It's a good way to start.
        </p>
        
        <div >
        <h2>Table of Contents</h2>
        <p>
            Just click in any link below to go to the selected section.
        </p>
        <ul class="toc_list">    
          <li><a href="#1.0">1.0 History</a>
          <li><a href="#2.0">2.0 About the Program</a>
          <li><a href="#3.0">3.0 Setup and Installation</a>
          <li><a href="#4.0">4.0 User Interface</a>
          <ul>
            <li><a href="#4.1">4.1 Main Program Window</a></li>
            <li><a href="#4.2">4.2 User Preferences Window</a></li>
            <li><a href="#4.3">4.3 Transmit from Alphabet Window</a></li>
            <li><a href="#4.4">4.4 Transmit From File Window</a></li>
            <li><a href="#4.5">4.5 Transmit From Keyboard Window</a></li>
          </ul>
        </li>
        <li><a href="#5.0">5.0 File and Program Structure</a></li>
        <li><a href="#6.0">6.0 Design of the Program</a></li>
        </ul>
        </div>
        
        <h3 id="1.0">1.0 History</h3>
        


        <p>
            I originally published this program on the MatLab side in 2009. This version, as of April 2019, is a major rewrite with many new features. A few of the more notable changes are summarized below:
        </p>
        <ul>
            <li>Completely redesigned user interface.</li>
            <li>Improved audio sound.</li>
            <li>Multiple users with preferences saved between sessions.</li>
            <li>Automatically saving new window positions upon closing.</li>
            <li>Consistent naming conventions for variables, functions and callbacks.</li>
            <li>Use of multiple function files to better organize the program and make maintenance simpler.</li>
            <li>Use of .mat files to save important preferences and other control parameters.</li>
            <li>Better and more detailed Help and comments.</li>
            <li>And many more.</li>
        </ul>
  
        <h3 id="2.0">2.0 About the Program</h3>
        <p>
            This program is a training aid to help the user learn and improve their proficiency in receiving Morse code. The program allows the user to generate Morse code in several ways:</p>
         <ul>
             <li>Transmit the alphabet.</li>
             <li>Transmit from a text file.</li>
             <li>Transmit from the keyboard.</li>
             <li>Transmit a recorded .wav file.</li>
         </ul>   
         <p> 
             The code speed (rate of dots and dashes), word speed (period between words) and audio frequency of transmitted dots and dashes can be set separately for each user profile. These parameters can be adjusted through the Preferences drop down menu on the main window.
        </p>
        <p>
            When the program is installed, it is initialized with a default user. The default user parameters cannot be changed. In order to customize the experience, new users must be added. Then the code speed, word speed and frequency can be set as the user desires. This is done through the user preferences drop-down menu on the main  program window. In addition, under the preferences menu is the ability to reset the program to its default state. This will erase any previously established users and their data and return the program to its original startup configuration.
        </p>
        <p>
            When transmitting either a text file or the alphabet, the operator can pause the transmission at any time. When transmitting a file the user must first select a file to be transmitted. The transmission will stop when the end of the file is reached or the transmission is paused by the user. All text in the file is converted to upper case as it is being used and all extra spaces between words are removed. When Transmitting Alphabet the user can select the alphabet content, whether it is transmitted sequentially or randomly, or whether to split the transmitted characters in groups of fixed or random sizes.       
        </p>
        <p>
            When Transmit Keyboard is selected, a window opens showing the keyboard entries and transmitted data. All input is converted to caps and the only special keys accepted are backspace, escape and F5. Backspace will delete the last keyboard input and Escape will clear all entries to start over. F5 is used to start and stop transmission. The imputed text is buffered and transmitted at the selected rates. 
        </p>
        <p> 
            From the menu bar under Help, selecting "Code Table" will display the code table built into the program. There are 60 entries in the table with the last being a word space. Selecting Help will display this file in the MatLab browser. Selecting About will provide author details and version number.
        </p>
        <h3 id="3.0">3.0 Setup and Installation</h3>
        <p>
            The program can be downloaded from the git repository located at <A href="https://github.com/jbwillmann/MorseCode.git">https://github.com/jbwillmann/MorseCode.git</A>. When the downloaded file, MorseCode-master.zip is extracted, the contents of that file is as shown below.
        </p>
        <a href="screenshots/ZipFileContents.png">
            <img alt="A screenshot showing ZipFileContents" src="screenshots/ZipFileContents.png" width="400"/>
        </a>
        <p>
           Each of these files is described in detail at <a href="#5.0">5.0 File and Program Structure</a>, however a few comments are appropriate here. 
        </p>
        <p>
           First, put the folder in your preferred location. You can change the name of the folder if you like. Next open MatLab and navigate to that folder. Then run the main file, Morse.m. The first time it is run it will initialize the program by creating the ProgramData directory and the UserData directory and the main window will open and you will be ready to proceed.
            
        </p>
        <h3 id="4.0">4.0 User Interface</h3>
        <p>
            In this section we review the user interface and describe each of the program windows and its operation.
        </p>
        <h4 id="4.1">4.1 Main Program Window</h4>
        <p> 
             This is the window that opens when the file morse.m is executed. Along the top is a drop down menu which allows you to change user preferences, select a .wav audio file for playback  or use the help system. In the center of the window is the username and the selected user code speed and word speed. Along the bottom are three action buttons allowing the user to either transmit the alphabet, transmit from a saved file, or transmitted code directly from the keyboard.
        </p>
        <a href="screenshots/MainProgramWindow.png">
            <img alt="A screenshot showing Main Program Window" src="screenshots/MainProgramWindow.png"/ width="500">
            
        </a><h5>4.1.1 Drop Down Menu</h5>
        <p>
        The drop down menu on the main program figure has the following choices:
        </p>
        <li><em>Preferences</em>
                <ul>
                    <li>UserPreferences - Opens the User Preferences to allow the user to make changes or select a different user
                    </li>
                    <li>
                    Window Preferences - Opens the Windows Preferences to allow the user to select save window position on exit
                    </li>
                    <li>
                    Reset All Preferences - Deletes all added users and returns the program to its initial state.
                    </li>
                </ul>             . 
            </li>
            <li><em>File</em>
                <ul>
                    <li>Play Audio File - Opens a file selector to pick an audio (.wav) file for playback
                    </li>
                </ul>             . 
            </li>
            <li><em>Help</em>
                <ul>
                    <li>Code Table - Displays the Morse Code table built into the program.
                    </li>
                    <li>
                    Help - Opens this file in the MatLab browser.
                    </li>
                    <li>
                    About - Displays version and author information.
                    </li>
                </ul>             . 
            </li>
        <p>------------------------------------------------------------------------------------------------------------------------------------------------------</p>
        <h5 id="4.1.1">4.1.1 User Preferences Window</h5>
        <p>
            When User Preferences is selected from the Preferences Drop Down Menu on the main window, the window shown below opens. 
        </p>
        <a href="screenshots/UserPreferencesWindow.png">
            <img alt="A screenshot showing User Preferences" src="screenshots/UserPreferencesWindow.png"/ width="400">
        </a>
        <p>
            This window displays the currently selected user at the top of the window. The drop down box labeled "Select a User" can be selected to allow you to "Add a New User" or to select a user from the list displayed.  If a user is selected, that users preferences are displayed and can be edited if desired. After the editing is complete, select "Save" to save the changes. If the user selected is not the "Currently Selected User", then "Make Active" can be selected and the current user will be replaced with the new or changed user.  Also the selected user can be deleted if desired.  Note that the Default User cannot be deleted or edited. Depending on the task being performed, only certain of the action buttons along the bottom of the window are displayed or enabled.
        </p>
        <p>------------------------------------------------------------------------------------------------------------------------------------------------------</p>
        <h5 id="4.1.2">4.1.2 Window Preferences Window</h5>
        <p>
            When Window Preferences is selected from the Preferences Drop Down Menu on the main window, the window shown below opens. 
        </p>
        <a href="screenshots/WindowPreferencesWindow.png">
            <img alt="A screenshot showing Window Preferences" src="screenshots/WindowPreferencesWindow.png"/ width="400">
        </a>
        <p>
            This window displays the currently selected user at the top of the window. There is a checkbox to select 'Save Window Position on Exit'. The default is checked. Once you like the position of windows and have saved those windows, then those windows will reopen at that position. If desired, after windows are positioned to your liking, the box can be unchecked to prevent further changes. The 'Scale Factor' is set to 1 by default. It is currently not used.
        </p>
        <p>------------------------------------------------------------------------------------------------------------------------------------------------------</p>
        <h4 id="4.2">4.2 Transmit from Alphabet Window</h4>
        <p>
            When Transmit Alphabet is selected on the main window, the window shown below opens.
        </p>
        <a href="screenshots/TransmitAlphabetWindow.png">
            <img alt="A screenshot showing Transmit Alphabet" src="screenshots/TransmitAlphabetWindow.png" />
        </a>
        <p>
            At the top of the window is the currently selected mode of operation.  This can be changed by selecting the Select Mode button at the bottom of the window.  The various options are displayed in the Alphabet Preferences Window described in section 3.3.1 below. 
        </p>
        <p>
            Selecting the Start Transmission button will begin the transmission. The Start Transmission will change into a Pause Transmission button that can selected to pause the transmission. Selecting Exit at any time will stop the transmission and close the window
        </p>
        <p>------------------------------------------------------------------------------------------------------------------------------------------------------</p>
        <h5 id="4.2.1">4.2.1 Alphabet Preferences Window</h5>
        <p>
            This window opens when Select Mode is selected from the Transmit Alphabet Window.
        </p>
        <a href="screenshots/AlphabetPreferencesWindow.png">
            <img alt="A screenshot showing Alphabet Preferences" src="screenshots/AlphabetPreferencesWindow.png" width="400"/>
        </a>
        <p>
            The first drop down allows the selection of alphabet, alphabet plus numbers, alphabet plus numbers plus punctuation or alphabet plus numbers plus punctuation plus special characters,  See the code table to see all of the characters included.
        </p>
        <p>
            The next dropdown provides a selection between transmitting sequentially from the table or a random selection from the selected character set.
        </p>
        <p>
            Next the user can select whether the transmission specified above in broken into code groups with a single space between groups. If the Min and Max are the same then all groups will be that size.  If Min is less than Max the size of each group will be randomly selected between those two sizes.
        </p>
        <p>
            When all choices are made and Save is selected, the Preferences file is updated and the TransmitAlphabet program is restarted to reflect the new settings.  Otherwise if Cancel is selected all entries are discarded and the window is closed.
        </p>
        <p>------------------------------------------------------------------------------------------------------------------------------------------------------</p>
        <h4 id="4.3">4.3 Transmit From File Window</h4>
         <p>
            When Transmit File is selected on the main window, the window shown below opens.
        </p>
        <a href="screenshots/TransmitFileWindow.png">
            <img alt="A screenshot showing Transmit Keyboard" src="screenshots/TransmitFileWindow.png" />
        </a>
        <p>
            Before you start you must first select a text file to playback. Selecting 'Select Input File' box will open a file selector window in the selected users Data directory.  You can navigate to any folder to select a file.  Once a file is selected that file name will be displayed at the top of the window.
        </p>
        <p>
            If you wish to save an audio file of the transmission, check the bod 'Save Audio File' before starting the transmission. After completion, that file will be saved in the users Data directory.
        </p>
        <p>
            To begin transmission select 'Start Transmission' and the text will be transmitted and displayed in the text areas above. After the transmission starts, the 'Start Transmission' button will change to a 'Pause Transmission'.
        </p>
        <p>
            The transmission will stop when an EOF is reached on the input text file 'Pause Transmission' is selected, Selecting 'Exit' will terminate the process.
        </p>
        
        <p>------------------------------------------------------------------------------------------------------------------------------------------------------</p>
        <h4 id="4.4">4.4 Transmit From Keyboard Window</h4>
         <p>
            When Transmit Keyboard is selected on the main window, the window shown below opens.
        </p>
        <a href="screenshots/TransmitKeyboardWindow.png">
            <img alt="A screenshot showing Transmit File" src="screenshots/TransmitKeyboardWindow.png" />
        </a>
        <p>
            At the top of the window the status of the F5 key is shown. Transmission can be started, paused or stopped with this key at any time. All input is converted to caps and the only special keys accepted are backspace, escape and F5. Backspace will delete the last keyboard input and Escape will clear all entries in order to start over.
        </p> 
        <p>
            As you are typing the input appears in the 'Keyboard Input' If transmission is on, the characters will move from that string to the 'Character Being Transmitted display area along with the name of the character immediately below. At the same time the character will go to the 'String Being Transmitted' area where all of the characters remain until the window is closed or the window is cleared by entering escape.  If you type ahead of the transmission, the characters in the 'Keyboard Input' can be edited using the delete key and retyping.
        </p> 
        <p>------------------------------------------------------------------------------------------------------------------------------------------------------</p>
    <h3 id="5.0">5.0 File and Program Structure</h3>
        <p>
            The following screenshot shows the directory structure and all of the system files used by the program. In what follows we describe each of the files in detail.
        </p>
        

        <a href="screenshots/DirectoryStructure.png">
            <img alt="A screenshot showing Directory Structure" src="screenshots/DirectoryStructure.png" width="400"/>
        </a>
        
        <ul>
            <li>
               <em>.git:</em> A file used by git. It wont be here if you are not using git for version control.
            </li>
            
            <li>
                 <em>MorseHelp Directory:</em> This directory contains the MorseHelp.html and main.css files used to display the help in any browser. It also contains a screenshots sub-directory that contains all of the screen shots displayed by the help system.
            </li>
            
            <li>
               <em>ProgramData Directory:</em> This directory contains the two .mat files used by the program.
                <ul>
                    <li>
                        PreferencesFile.mat contains all of the user and window preferences used by the program to manage all of the windows and user preferences data
                    </li>
                    <li>
                         CodeTableFile.mat contains the audio samples using the user selected preferences for transmission by the program.  Whenever the user is changed or some of the currently selected user parameters are changed, this file is automatically regenerated.
                    </li>
                </ul>             . 
            </li>
            
            <li>
                <em>UserData Directory:</em> The UserData directory has a sub-directory for each user. There is a built-in user that is not changeable called the DefaultUser. This is the only user that shows when the system is first installed. As other users are added with their custom settings, then sub-directories with the new user name are added. Typically, this is where each user stores text files for transmission as well as any .wav files the user creates.
            
            </li>
            
            <li
                ><em>.gitattributes:</em> Used by the git system. You can delete if you are not using git.
            </li>
            
            <li>
                <em>AlphabetPreferences.m:</em>
            </li>
            
            <li>
                <em>BuildCodeTable.m:</em>
            </li>
            
            <li>
                <em>CloseWindow.m:</em>
            </li>
            
            <li>
                <em>CreatePrefsArray.m:</em>
            </li>
            
            <li>
                <em>DisplayCodeTable.m:</em>
            </li>
            
            <li>
                <em>FillCodeTable.m:</em>
            </li>
            
            <li>
                <em>HelpAndAboutDisplay.m:</em>
            </li>
            
            <li>
                <em>InitializeProgram.m:</em>
            </li>
            
            <li>
                <em>LICENSE:</em>
            </li>
            
            <li>
                <em>Morse.m:</em>
            </li>

            <li>
                <em>ProcessInputFile.m:</em>
            </li>
            
            <li>
                <em>README.md:</em>
            </li>
            
            <li>
                <em>startup.m:</em>
            </li>
            
            <li>
                <em>TransmitAlphabet.m:</em>
            </li>
            
            <li>
                <em>TransmitFile.m:</em>
            </li>
            
            <li>
                <em>TransmitKeyboard.m:</em>      
            </li>
            
            <li>
                <em>UserPreferences.m:</em>
            </li>
            
            <li>
                <em>WarningWindow.m:</em>
            </li>
            
            <li>
                <em>WavePlay.m:</em>
            </li>
              
            <li>
                <em>WindowPreferences.m:</em>
            </li>  
               
        </ul>

        <h3 id="6.0">6.0 Design of the Program</h3>
        <p>
            The core of the program is the CodeTable. The function BuildCodeTable creates a 60x4 cell array where the first 3 columns are text and contain the character, dots and dashes, dits and daws. The fourth column is reserved for a wave file that represents the Morse code for that character at the selected speed and audio frequency.
            After the GUI is constricted, to initialize the program the function FillCodeTable is called. This function first calls BuildCodeTable to populate the first three columns of the CodeTable. Then this function builds the dots dashes and spaces for the selected code and word speed by calling the function MakeWave to build the wave file for a dot, dash and spaces. Then MakeCharacter is called to build the wave file for each character. This result is stored in the fourth column of the CodeTable for each of the character entries in the table.
            When either the speed or frequency is changed, this process is repeated so there is a new CodeTable constructed to use with the new settings. The process of transmission consist of taking each character of the input stream and sending it to the standard audio output using waveplay. Because waveplay does not return until the sample is sent, when sending the alphabet or a loaded text string, the functions XmitAlphabetCallback and XmitFileCallback just loop through all of the characters until completed.
            Transmitting from the keyboard is a bit more complicated. The XmitKbdCallback starts a timer task and opens a small modal window activating the KeyPressFunction which links to GetKeyCallback. At GetKeyCallback each keyboard entry is put into a 2xn cell array InputString. In row 1 is the character and in row 2 is the wave file for that character. This is continued until the operator presses escape. Then the character string 'end' in placed in the character slot and the keyboard entry process is terminated.
            All the while this input is going on the timer task, TimerTaskCallback, is looking at the InputString to see if there is a new character. If there is, it is transmitted, and the program does not return until the transmission is complete. Then the timer task continues and repeats this process until it finds the string 'end' and then terminates.
        </p>

        
    </body>
</html>

